<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
      }
      .header {
        background: linear-gradient(135deg, #8B5CF6, #6D28D9);
        color: white;
        padding: 20px;
        border-radius: 8px 8px 0 0;
        text-align: center;
      }
      .header h1 {
        margin: 0;
        font-size: 24px;
      }
      .content {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-top: none;
        padding: 20px;
        border-radius: 0 0 8px 8px;
      }
      .info-grid {
        display: grid;
        grid-template-columns: 150px 1fr;
        gap: 10px;
        margin: 20px 0;
      }
      .label {
        font-weight: 600;
        color: #6B7280;
      }
      .value {
        color: #1F2937;
      }
      .error-message {
        background: #FEF2F2;
        border-left: 4px solid #EF4444;
        padding: 15px;
        margin: 20px 0;
        border-radius: 4px;
      }
      .error-message code {
        background: #FEE2E2;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 14px;
        color: #991B1B;
      }
      .backtrace {
        background: #F9FAFB;
        border: 1px solid #E5E7EB;
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
        margin: 20px 0;
      }
      .backtrace pre {
        margin: 0;
        font-size: 12px;
        color: #4B5563;
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      .badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
      }
      .badge-production {
        background: #FEE2E2;
        color: #991B1B;
      }
      .badge-staging {
        background: #FEF3C7;
        color: #92400E;
      }
      .badge-development {
        background: #D1FAE5;
        color: #065F46;
      }
      .badge-ios {
        background: #000000;
        color: #FFFFFF;
      }
      .badge-android {
        background: #3DDC84;
        color: #000000;
      }
      .badge-api {
        background: #DBEAFE;
        color: #1E40AF;
      }
      .button {
        display: inline-block;
        background: #8B5CF6;
        color: white;
        padding: 12px 24px;
        text-decoration: none;
        border-radius: 6px;
        font-weight: 600;
        margin: 20px 0;
      }
      .button:hover {
        background: #7C3AED;
      }
      .footer {
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid #E5E7EB;
        color: #6B7280;
        font-size: 12px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>ðŸš¨ Error Alert</h1>
    </div>

    <div class="content">
      <div class="info-grid">
        <div class="label">Error Type:</div>
        <div class="value"><code><%= @error_log.error_type %></code></div>

        <% if @error_log.platform.present? %>
          <div class="label">Platform:</div>
          <div class="value">
            <span class="badge badge-<%= @error_log.platform.downcase %>">
              <%= @error_log.platform %>
            </span>
          </div>
        <% end %>

        <div class="label">Occurred At:</div>
        <div class="value"><%= @error_log.occurred_at.strftime('%B %d, %Y at %I:%M %p %Z') %></div>

        <% if @error_log.user_id.present? %>
          <div class="label">User ID:</div>
          <div class="value"><%= @error_log.user_id %></div>
        <% end %>

        <% if @error_log.ip_address.present? %>
          <div class="label">IP Address:</div>
          <div class="value"><%= @error_log.ip_address %></div>
        <% end %>

        <% if @error_log.request_url.present? %>
          <div class="label">Request URL:</div>
          <div class="value"><%= @error_log.request_url %></div>
        <% end %>
      </div>

      <div class="error-message">
        <strong>Message:</strong><br/>
        <code><%= @error_log.message %></code>
      </div>

      <% if @error_log.backtrace.present? %>
        <div class="backtrace">
          <strong>Stack Trace (first 10 lines):</strong>
          <pre><%= @error_log.backtrace.split("\n").first(10).join("\n") %></pre>
        </div>
      <% end %>

      <div style="text-align: center;">
        <a href="<%= @dashboard_url %>" class="button">
          View Full Details in Dashboard
        </a>
      </div>

      <div class="footer">
        <p>
          This is an automated error notification from Rails Error Dashboard.<br/>
          Error ID: <%= @error_log.id %>
        </p>
      </div>
    </div>
  </body>
</html>
